#!/bin/bash
# Ubuntu Sauce Launcher - Interface Gr√°fica
# Maintainer: Berttone AKA Racxus

show_main_interface() {
    choice=$(zenity --question \
        --title="Ubuntu Sauce - Berttone AKA Racxus" \
        --text="<b>Instalador de Codecs Ubuntu Sauce</b>\n\nEste instalador vai adicionar:\n‚Ä¢ FFmpeg e codecs de v√≠deo\n‚Ä¢ Ubuntu Restricted Extras\n‚Ä¢ Drivers Mesa VA-API\n‚Ä¢ Suporte a DVD\n‚Ä¢ Codecs AV1 e H.264\n\nDeseja continuar com a instala√ß√£o?" \
        --ok-label="Instalar Codecs" \
        --cancel-label="Sair" \
        --width=450 \
        --height=250)
    
    if [ $? -eq 0 ]; then
        install_codecs
    else
        zenity --info \
            --title="Ubuntu Sauce" \
            --text="Instala√ß√£o cancelada.\n\nVoc√™ pode executar novamente pelo menu de aplicativos." \
            --width=300
        exit 0
    fi
}

install_codecs() {
    (
        echo "10" ; echo "# Atualizando lista de pacotes..." ; sudo apt update > /dev/null 2>&1
        echo "30" ; echo "# Instalando FFmpeg..." ; sudo apt install -y ffmpeg > /dev/null 2>&1
        echo "50" ; echo "# Instalando Ubuntu Restricted Extras..." ; sudo apt install -y ubuntu-restricted-extras > /dev/null 2>&1
        echo "70" ; echo "# Instalando codecs extras..." ; sudo apt install -y libavcodec-extra mesa-va-drivers > /dev/null 2>&1
        echo "85" ; echo "# Instalando suporte a DVD..." ; sudo apt install -y libdvd-pkg > /dev/null 2>&1
        echo "90" ; echo "# Configurando pacotes..." ; sudo dpkg-reconfigure libdvd-pkg -f noninteractive > /dev/null 2>&1
        echo "100" ; echo "# Finalizando instala√ß√£o..." ; sleep 2
    ) | zenity --progress \
        --title="Instalando Codecs" \
        --text="Preparando instala√ß√£o..." \
        --percentage=0 \
        --auto-close \
        --width=400
    
    if [ $? -eq 0 ]; then
        zenity --info \
            --title="Instala√ß√£o Conclu√≠da" \
            --text="‚úÖ <b>Todos os codecs foram instalados com sucesso!</b>\n\nüé¨ Agora voc√™ tem suporte completo a v√≠deos e √°udio.\n\nSistema preparado para multim√≠dia!" \
            --width=400
    else
        zenity --warning \
            --title="Aviso" \
            --text="‚ö† A instala√ß√£o pode n√£o ter sido completada.\n\nExecute no terminal:\n<b>sudo apt install -f</b>" \
            --width=350
    fi
}

show_main_interface
